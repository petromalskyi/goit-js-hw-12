{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst formEl = document.querySelector('form');\nconst listEl = document.querySelector('.gallery');\nconst loadMoreEl = document.querySelector('.js-btn-load');\n\nlet userEntered = '';\nlet currentPage = 1;\nlet perPage = 40;\nlet loaderEl = '';\n\nformEl.addEventListener('submit', handleSubmit);\nloadMoreEl.addEventListener('click', onLoadMore);\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nfunction onLoadMore() {\n  currentPage += 1;\n  loadMoreEl.classList.toggle('hidden');\n  loadMoreEl.insertAdjacentHTML('afterend', '<span class=\"loader\"></span>');\n  loaderEl = document.querySelector('.loader');\n\n  getGallery(userEntered, currentPage)\n    .then(data => {\n      if (!data.hits.length) {\n        iziToastError();\n        return;\n      } else {\n        if (data.totalHits - (currentPage - 1) * perPage <= perPage) {\n          perPage = data.totalHits - currentPage * perPage;\n          iziToastWarning();\n        } else {\n          loadMoreEl.classList.remove('hidden');\n        }\n      }\n      return createMarkup(data.hits);\n    })\n    .catch(err => console.log(err));\n}\n\nfunction handleSubmit(event) {\n  event.preventDefault();\n  listEl.innerHTML = '';\n  currentPage = 1;\n  perPage = 40;\n  userEntered = event.target.elements.name.value;\n\n  loadMoreEl.insertAdjacentHTML('afterend', '<span class=\"loader\"></span>');\n  loaderEl = document.querySelector('.loader');\n\n  getGallery(userEntered)\n    .then(data => {\n      if (!data.hits.length) {\n        iziToastError();\n        return;\n      } else {\n        if (data.totalHits - (currentPage - 1) * perPage <= perPage) {\n          perPage = data.totalHits - currentPage * perPage; //- (currentPage - 1) * perPage;\n          iziToastWarning();\n        } else {\n          loadMoreEl.classList.remove('hidden');\n        }\n      }\n\n      return createMarkup(data.hits);\n    })\n\n    .catch(err => console.log(err));\n}\n\nasync function getGallery(userEntered) {\n  const API_KEY = '41437501-0a58a7d6f9b55a91ef815cfe0';\n  axios.defaults.baseURL = 'https://pixabay.com/api';\n\n  const response = await axios.get(\n    `/?key=${API_KEY}&q=${userEntered}&image_type=photo&orientation=horizontal&safesearch=true&per_page=${perPage}&page=${currentPage}`,\n  );\n\n  return response.data;\n}\n\nfunction createMarkup(array) {\n  const markup = array.reduce(\n    (\n      html,\n      { largeImageURL, previewURL, tags, likes, views, comments, downloads },\n    ) =>\n      html +\n      `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n            class=\"gallery-image\"\n            src=\"${previewURL}\"\n            alt=\"${tags}\"\n            width=\"360\"\n            height=\"200\"\n            ;\n            />\n            <div class=\"gallery-info\">\n              <div class=\"gallery-box\">\n                <h3 class=\"gallery-title\">likes</h3>\n                <p class=\"gallery-text\">${likes}</p>\n                <!--hit.likes -->\n              </div>\n              <div class=\"gallery-box\">\n                <h3 class=\"gallery-title\">views</h3>\n                <p class=\"gallery-text\">${views}</p>\n              </div>\n              <div class=\"gallery-box\">\n                <h3 class=\"gallery-title\">comments</h3>\n                <p class=\"gallery-text\">${comments}</p>\n              </div>\n              <div class=\"gallery-box\">\n                <h3 class=\"gallery-title\">downloads</h3>\n                <p class=\"gallery-text\">${downloads}</p>\n              </div>\n            </div>\n         </a>\n       </li>`,\n    '',\n  );\n\n  listEl.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n\n  loaderEl.remove();\n\n  window.scrollBy({\n    top: listEl.getBoundingClientRect().height,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction iziToastError() {\n  loadMoreEl.classList.add('hidden');\n  loaderEl.remove();\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n    messageColor: '#ffffff',\n    titleColor: '#ffffff',\n    iconColor: '#ffffff',\n    backgroundColor: '#B51B1B',\n  });\n}\n\nfunction iziToastWarning() {\n  loadMoreEl.classList.add('hidden');\n  loaderEl.remove();\n  iziToast.warning({\n    title: 'Caution',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    position: 'topRight',\n    messageColor: '#000000',\n    titleColor: '#000000',\n    iconColor: '#000000',\n    backgroundColor: '#06bb3c',\n  });\n}\n"],"names":["formEl","listEl","loadMoreEl","userEntered","currentPage","perPage","loaderEl","handleSubmit","onLoadMore","lightbox","SimpleLightbox","getGallery","data","iziToastWarning","iziToastError","createMarkup","err","event","API_KEY","axios","array","markup","html","largeImageURL","previewURL","tags","likes","views","comments","downloads","iziToast"],"mappings":"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"}