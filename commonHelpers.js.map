{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst formEl = document.querySelector('form');\nconst listEl = document.querySelector('.gallery');\nconst loadMoreEl = document.querySelector('.js-btn-load');\n\nconst perPage = 40;\nlet userEntered = '';\nlet currentPage = 1;\nlet loaderEl = '';\n\nformEl.addEventListener('submit', handleSubmit);\nloadMoreEl.addEventListener('click', onLoadMore);\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nasync function onLoadMore() {\n  currentPage += 1;\n  loadMoreEl.classList.toggle('hidden');\n  loadMoreEl.insertAdjacentHTML('afterend', '<span class=\"loader\"></span>');\n  loaderEl = document.querySelector('.loader');\n\n  try {\n    const data = await getGallery(userEntered);\n    if (!data.hits.length) {\n      iziToastError();\n      return;\n    } else {\n      if (data.totalHits - (currentPage - 1) * perPage <= perPage) {\n        iziToastWarning();\n      } else {\n        loadMoreEl.classList.remove('hidden');\n      }\n    }\n\n    return createMarkup(data.hits);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  listEl.innerHTML = '';\n  currentPage = 1;\n  userEntered = event.currentTarget.elements.name.value;\n\n  loadMoreEl.insertAdjacentHTML('afterend', '<span class=\"loader\"></span>');\n  loaderEl = document.querySelector('.loader');\n\n  try {\n    const data = await getGallery(userEntered);\n    if (!data.hits.length) {\n      iziToastError();\n      return;\n    } else {\n      if (data.totalHits - (currentPage - 1) * perPage <= perPage) {\n        iziToastWarning();\n      } else {\n        loadMoreEl.classList.remove('hidden');\n      }\n    }\n\n    return createMarkup(data.hits);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function getGallery(userEntered) {\n  const API_KEY = '41437501-0a58a7d6f9b55a91ef815cfe0';\n  axios.defaults.baseURL = 'https://pixabay.com/api';\n\n  const response = await axios.get(\n    `/?key=${API_KEY}&q=${userEntered}&image_type=photo&orientation=horizontal&safesearch=true&per_page=${perPage}&page=${currentPage}`,\n  );\n\n  return response.data;\n}\n\nfunction createMarkup(array) {\n  const markup = array.reduce(\n    (\n      html,\n      { largeImageURL, webformatURL, tags, likes, views, comments, downloads },\n    ) =>\n      html +\n      `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n            width=\"360\"\n            height=\"200\"\n            />\n            <div class=\"gallery-info\">\n              <div class=\"gallery-box\">\n                <h3 class=\"gallery-title\">likes</h3>\n                <p class=\"gallery-text\">${likes}</p>\n              </div>\n              <div class=\"gallery-box\">\n                <h3 class=\"gallery-title\">views</h3>\n                <p class=\"gallery-text\">${views}</p>\n              </div>\n              <div class=\"gallery-box\">\n                <h3 class=\"gallery-title\">comments</h3>\n                <p class=\"gallery-text\">${comments}</p>\n              </div>\n              <div class=\"gallery-box\">\n                <h3 class=\"gallery-title\">downloads</h3>\n                <p class=\"gallery-text\">${downloads}</p>\n              </div>\n            </div>\n         </a>\n       </li>`,\n    '',\n  );\n\n  listEl.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n\n  if (loaderEl) {\n    loaderEl.remove();\n  }\n\n  window.scrollBy({\n    top: listEl.getBoundingClientRect().height,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction iziToastError() {\n  loadMoreEl.classList.add('hidden');\n  if (loaderEl) {\n    loaderEl.remove();\n  }\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n    messageColor: '#ffffff',\n    titleColor: '#ffffff',\n    iconColor: '#ffffff',\n    backgroundColor: '#B51B1B',\n  });\n}\n\nfunction iziToastWarning() {\n  loadMoreEl.classList.add('hidden');\n  if (loaderEl) {\n    loaderEl.remove();\n  }\n  iziToast.warning({\n    title: 'Caution',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    position: 'topRight',\n    messageColor: '#000000',\n    titleColor: '#000000',\n    iconColor: '#000000',\n    backgroundColor: '#06bb3c',\n  });\n}\n"],"names":["formEl","listEl","loadMoreEl","perPage","userEntered","currentPage","loaderEl","handleSubmit","onLoadMore","lightbox","SimpleLightbox","data","getGallery","iziToastWarning","iziToastError","createMarkup","error","event","API_KEY","axios","array","markup","html","largeImageURL","webformatURL","tags","likes","views","comments","downloads","iziToast"],"mappings":"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"}